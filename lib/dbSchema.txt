CREATE SCHEMA krasiva;
USE krasiva;

CREATE TABLE krasiva.user(
email VARCHAR(255) PRIMARY KEY NOT NULL ,
nickname VARCHAR(255) NOT NULL,
password VARCHAR(50) NOT NULL,
firstName VARCHAR(50) NOT NULL,
lastName VARCHAR(50) NOT NULL);

CREATE TABLE krasiva.album(
	albumID BIGINT AUTO_INCREMENT PRIMARY KEY NOT NULL,
    name VARCHAR(255) NOT NULL,
    userEmail VARCHAR(255) NOT NULL,
    FOREIGN KEY (userEmail) REFERENCES user(email)
    ON DELETE CASCADE ON UPDATE CASCADE
    );
    
CREATE TABLE krasiva.post(
	postID BIGINT AUTO_INCREMENT PRIMARY KEY NOT NULL,
    photo BLOB NOT NULL,
    description TEXT DEFAULT NULL,
    category VARCHAR(255) NOT NULL,
    dateTime DATETIME NOT NULL,
    likes INT,
    userEmail VARCHAR(255),
    FOREIGN KEY(userEmail) REFERENCES user(email)
    ON DELETE CASCADE ON UPDATE CASCADE
    );
    
CREATE TABLE krasiva.albumPosts(
	albumID BIGINT NOT NULL,
    postID BIGINT NOT NULL,
    PRIMARY KEY(albumID, postID),
    FOREIGN KEY(albumID) REFERENCES album(albumID) ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY(postID) REFERENCES post(postID) ON DELETE CASCADE ON UPDATE CASCADE
    );

CREATE TABLE krasiva.comment(
	commentID BIGINT AUTO_INCREMENT PRIMARY KEY NOT NULL,
	content VARCHAR(255) NOT NULL,
	dateTime DATETIME NOT NULL,
	likes INT,
	dislikes INT,
	postID BIGINT NOT NULL,
	userEmail VARCHAR(255) NOT NULL,
	FOREIGN KEY (postID) REFERENCES post(postID) ON DELETE CASCADE ON UPDATE CASCADE,
	FOREIGN KEY (userEmail) REFERENCES user(email) ON DELETE CASCADE ON UPDATE CASCADE
	);
    
CREATE TABLE krasiva.userLikedPosts(
	userEmail VARCHAR(255) NOT NULL,
    postID BIGINT NOT NULL,
    PRIMARY KEY(userEmail, postID),
    FOREIGN KEY(userEmail) REFERENCES user(email) ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY(postID) REFERENCES post(postID) ON DELETE CASCADE ON UPDATE CASCADE
    );